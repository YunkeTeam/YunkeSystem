<?xml version="1.0" encoding="UTF-8" ?>
<!DOCTYPE mapper
        PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"
        "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<!-- namespace 写接口的全限定名 -->
<mapper namespace="com.titos.conversation.dao.ConversationDao">
    <!-- id写接口里面的方法 ，返回类型是类-->
    <select id="selectAllDialog" resultType="com.titos.conversation.po.MessagePO">
        select id,
               send_id as sendId,
               receive_id as receiveId,
               content,
               image_addr as imageAddr,
               release_time as releaseTime,
               is_complete as isComplete
        from message
        where (send_id = #{id} and receive_id = #{otherId})
           or (send_id = #{otherId} and receive_id = #{id})
    </select>

    <delete id="deleteDialog">
        delete from message
        where (send_id = #{id} and receive_id = #{otherId})
           or (send_id = #{otherId} and receive_id = #{id})
    </delete>

    <insert id="insertDialog">
        insert into message(send_id, receive_id, content, image_addr, release_time, is_complete)
        values(#{id}, #{otherId}, #{message}, #{message}, now(), 0)
    </insert>

    <insert id="insertFriend">
        insert into contactperson(user_id, friend_id)
        values(#{id}, #{otherId})
    </insert>

    <delete id="deleteFriend">
        delete from contactperson
        where  (user_id = #{id} and friend_id = #{otherId})
           or (friend_id = #{otherId} and user_id = #{id})
    </delete>

</mapper>